{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":34,"index":34}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"expo-router","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":35},"end":{"line":2,"column":40,"index":75}}],"key":"/+ErnBisjrT6aDU+GRp5Qz/lYoY=","exportNames":["*"],"imports":1}},{"name":"@/utils/auth/useAuth","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":76},"end":{"line":3,"column":47,"index":123}}],"key":"OwmwtjBeuaoeWH+HHIznha/uOFE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return Index;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _react = require(_dependencyMap[1], \"react\");\n  var _expoRouter = require(_dependencyMap[2], \"expo-router\");\n  var _utilsAuthUseAuth = require(_dependencyMap[3], \"@/utils/auth/useAuth\");\n  function Index() {\n    _s();\n    var router = (0, _expoRouter.useRouter)();\n    var _useAuth = (0, _utilsAuthUseAuth.useAuth)(),\n      isReady = _useAuth.isReady,\n      auth = _useAuth.auth;\n    (0, _react.useEffect)(() => {\n      var routeNext = /*#__PURE__*/function () {\n        var _ref = (0, _asyncToGenerator.default)(function* () {\n          if (!isReady) return;\n\n          // Not authenticated -> Welcome\n          if (!auth) {\n            router.replace(\"/onboarding/welcome\");\n            return;\n          }\n          try {\n            var res = yield fetch(\"/api/profile\");\n            if (res.ok) {\n              var data = yield res.json();\n              var user = data?.user;\n              var media = data?.media || [];\n              var photos = media.filter(m => m.type === \"photo\");\n\n              // NEW FLOW: Check consent first (Step 2 before membership)\n              if (!user?.consent_accepted) {\n                var returnTo = \"/onboarding/membership\";\n                router.replace(`/onboarding/consent?returnTo=${encodeURIComponent(returnTo)}`);\n                return;\n              }\n\n              // Membership gate (Step 3)\n              if (!user?.membership_tier) {\n                router.replace(\"/onboarding/membership\");\n                return;\n              }\n\n              // Profile completion gate (Step 4 - consolidated)\n              // Require name AND minimum 2 photos to ensure profile is properly completed\n              if (!user?.name || photos.length < 2) {\n                router.replace(\"/onboarding/profile\");\n                return;\n              }\n\n              // All checks passed -> main app\n              router.replace(\"/(tabs)/discovery\");\n              return;\n            }\n          } catch (e) {\n            console.error(\"/index bootstrap routeNext error\", e);\n          }\n\n          // Fallback to main tabs if profile fetch fails\n          router.replace(\"/(tabs)/discovery\");\n        });\n        return function routeNext() {\n          return _ref.apply(this, arguments);\n        };\n      }();\n      routeNext();\n    }, [isReady, auth, router]);\n    return null;\n  }\n  _s(Index, \"1ebaCb4fb+n283sTuLOePoZ/b3c=\", false, function () {\n    return [_expoRouter.useRouter, _utilsAuthUseAuth.useAuth];\n  });\n  _c = Index;\n  var _c;\n  $RefreshReg$(_c, \"Index\");\n});","lineCount":93,"map":[[13,2,5,15,"Object"],[13,8,5,15],[13,9,5,15,"defineProperty"],[13,23,5,15],[13,24,5,15,"exports"],[13,31,5,15],[14,4,5,15,"enumerable"],[14,14,5,15],[15,4,5,15,"get"],[15,7,5,15],[15,18,5,15,"get"],[15,19,5,15],[16,6,5,15],[16,13,5,15,"Index"],[16,18,5,15],[17,4,5,15],[18,2,5,15],[19,2,63,1],[19,6,63,1,"_babelRuntimeHelpersAsyncToGenerator"],[19,42,63,1],[19,45,63,1,"require"],[19,52,63,1],[19,53,63,1,"_dependencyMap"],[19,67,63,1],[20,2,63,1],[20,6,63,1,"_asyncToGenerator"],[20,23,63,1],[20,26,63,1,"_interopDefault"],[20,41,63,1],[20,42,63,1,"_babelRuntimeHelpersAsyncToGenerator"],[20,78,63,1],[21,2,1,0],[21,6,1,0,"_react"],[21,12,1,0],[21,15,1,0,"require"],[21,22,1,0],[21,23,1,0,"_dependencyMap"],[21,37,1,0],[22,2,2,0],[22,6,2,0,"_expoRouter"],[22,17,2,0],[22,20,2,0,"require"],[22,27,2,0],[22,28,2,0,"_dependencyMap"],[22,42,2,0],[23,2,3,0],[23,6,3,0,"_utilsAuthUseAuth"],[23,23,3,0],[23,26,3,0,"require"],[23,33,3,0],[23,34,3,0,"_dependencyMap"],[23,48,3,0],[24,2,5,15],[24,11,5,24,"Index"],[24,16,5,29,"Index"],[24,17,5,29],[24,19,5,32],[25,4,5,32,"_s"],[25,6,5,32],[26,4,6,2],[26,8,6,8,"router"],[26,14,6,14],[26,17,6,17],[26,21,6,17,"useRouter"],[26,32,6,26],[26,33,6,26,"useRouter"],[26,42,6,26],[26,44,6,27],[26,45,6,28],[27,4,7,2],[27,8,7,2,"_useAuth"],[27,16,7,2],[27,19,7,28],[27,23,7,28,"useAuth"],[27,40,7,35],[27,41,7,35,"useAuth"],[27,48,7,35],[27,50,7,36],[27,51,7,37],[28,6,7,10,"isReady"],[28,13,7,17],[28,16,7,17,"_useAuth"],[28,24,7,17],[28,25,7,10,"isReady"],[28,32,7,17],[29,6,7,19,"auth"],[29,10,7,23],[29,13,7,23,"_useAuth"],[29,21,7,23],[29,22,7,19,"auth"],[29,26,7,23],[30,4,9,2],[30,8,9,2,"useEffect"],[30,14,9,11],[30,15,9,11,"useEffect"],[30,24,9,11],[30,26,9,12],[30,32,9,18],[31,6,10,4],[31,10,10,10,"routeNext"],[31,19,10,19],[32,8,10,19],[32,12,10,19,"_ref"],[32,16,10,19],[32,23,10,19,"_asyncToGenerator"],[32,40,10,19],[32,41,10,19,"default"],[32,48,10,19],[32,50,10,22],[32,63,10,34],[33,10,11,6],[33,14,11,10],[33,15,11,11,"isReady"],[33,22,11,18],[33,24,11,20],[35,10,13,6],[36,10,14,6],[36,14,14,10],[36,15,14,11,"auth"],[36,19,14,15],[36,21,14,17],[37,12,15,8,"router"],[37,18,15,14],[37,19,15,15,"replace"],[37,26,15,22],[37,27,15,23],[37,48,15,44],[37,49,15,45],[38,12,16,8],[39,10,17,6],[40,10,19,6],[40,14,19,10],[41,12,20,8],[41,16,20,14,"res"],[41,19,20,17],[41,28,20,26,"fetch"],[41,33,20,31],[41,34,20,32],[41,48,20,46],[41,49,20,47],[42,12,21,8],[42,16,21,12,"res"],[42,19,21,15],[42,20,21,16,"ok"],[42,22,21,18],[42,24,21,20],[43,14,22,10],[43,18,22,16,"data"],[43,22,22,20],[43,31,22,29,"res"],[43,34,22,32],[43,35,22,33,"json"],[43,39,22,37],[43,40,22,38],[43,41,22,39],[44,14,23,10],[44,18,23,16,"user"],[44,22,23,20],[44,25,23,23,"data"],[44,29,23,27],[44,31,23,29,"user"],[44,35,23,33],[45,14,24,10],[45,18,24,16,"media"],[45,23,24,21],[45,26,24,24,"data"],[45,30,24,28],[45,32,24,30,"media"],[45,37,24,35],[45,41,24,39],[45,43,24,41],[46,14,25,10],[46,18,25,16,"photos"],[46,24,25,22],[46,27,25,25,"media"],[46,32,25,30],[46,33,25,31,"filter"],[46,39,25,37],[46,40,25,39,"m"],[46,41,25,40],[46,45,25,45,"m"],[46,46,25,46],[46,47,25,47,"type"],[46,51,25,51],[46,56,25,56],[46,63,25,63],[46,64,25,64],[48,14,27,10],[49,14,28,10],[49,18,28,14],[49,19,28,15,"user"],[49,23,28,19],[49,25,28,21,"consent_accepted"],[49,41,28,37],[49,43,28,39],[50,16,29,12],[50,20,29,18,"returnTo"],[50,28,29,26],[50,31,29,29],[50,55,29,53],[51,16,30,12,"router"],[51,22,30,18],[51,23,30,19,"replace"],[51,30,30,26],[51,31,30,27],[51,63,30,59,"encodeURIComponent"],[51,81,30,77],[51,82,30,78,"returnTo"],[51,90,30,86],[51,91,30,87],[51,93,30,89],[51,94,30,90],[52,16,31,12],[53,14,32,10],[55,14,34,10],[56,14,35,10],[56,18,35,14],[56,19,35,15,"user"],[56,23,35,19],[56,25,35,21,"membership_tier"],[56,40,35,36],[56,42,35,38],[57,16,36,12,"router"],[57,22,36,18],[57,23,36,19,"replace"],[57,30,36,26],[57,31,36,27],[57,55,36,51],[57,56,36,52],[58,16,37,12],[59,14,38,10],[61,14,40,10],[62,14,41,10],[63,14,42,10],[63,18,42,14],[63,19,42,15,"user"],[63,23,42,19],[63,25,42,21,"name"],[63,29,42,25],[63,33,42,29,"photos"],[63,39,42,35],[63,40,42,36,"length"],[63,46,42,42],[63,49,42,45],[63,50,42,46],[63,52,42,48],[64,16,43,12,"router"],[64,22,43,18],[64,23,43,19,"replace"],[64,30,43,26],[64,31,43,27],[64,52,43,48],[64,53,43,49],[65,16,44,12],[66,14,45,10],[68,14,47,10],[69,14,48,10,"router"],[69,20,48,16],[69,21,48,17,"replace"],[69,28,48,24],[69,29,48,25],[69,48,48,44],[69,49,48,45],[70,14,49,10],[71,12,50,8],[72,10,51,6],[72,11,51,7],[72,12,51,8],[72,19,51,15,"e"],[72,20,51,16],[72,22,51,18],[73,12,52,8,"console"],[73,19,52,15],[73,20,52,16,"error"],[73,25,52,21],[73,26,52,22],[73,60,52,56],[73,62,52,58,"e"],[73,63,52,59],[73,64,52,60],[74,10,53,6],[76,10,55,6],[77,10,56,6,"router"],[77,16,56,12],[77,17,56,13,"replace"],[77,24,56,20],[77,25,56,21],[77,44,56,40],[77,45,56,41],[78,8,57,4],[78,9,57,5],[79,8,57,5],[79,24,10,10,"routeNext"],[79,33,10,19,"routeNext"],[79,34,10,19],[80,10,10,19],[80,17,10,19,"_ref"],[80,21,10,19],[80,22,10,19,"apply"],[80,27,10,19],[80,34,10,19,"arguments"],[80,43,10,19],[81,8,10,19],[82,6,10,19],[82,9,57,5],[83,6,59,4,"routeNext"],[83,15,59,13],[83,16,59,14],[83,17,59,15],[84,4,60,2],[84,5,60,3],[84,7,60,5],[84,8,60,6,"isReady"],[84,15,60,13],[84,17,60,15,"auth"],[84,21,60,19],[84,23,60,21,"router"],[84,29,60,27],[84,30,60,28],[84,31,60,29],[85,4,62,2],[85,11,62,9],[85,15,62,13],[86,2,63,0],[87,2,63,1,"_s"],[87,4,63,1],[87,5,5,24,"Index"],[87,10,5,29],[88,4,5,29],[88,12,6,17,"useRouter"],[88,23,6,26],[88,24,6,26,"useRouter"],[88,33,6,26],[88,35,7,28,"useAuth"],[88,52,7,35],[88,53,7,35,"useAuth"],[88,60,7,35],[89,2,7,35],[90,2,7,35,"_c"],[90,4,7,35],[90,7,5,24,"Index"],[90,12,5,29],[91,2,5,29],[91,6,5,29,"_c"],[91,8,5,29],[92,2,5,29,"$RefreshReg$"],[92,14,5,29],[92,15,5,29,"_c"],[92,17,5,29],[93,0,5,29],[93,3]],"functionMap":{"names":["<global>","Index","useEffect$argument_0","routeNext","media.filter$argument_0"],"mappings":"AAA;eCI;YCI;sBCC;sCCe,yBD;KDgC;GDG;CDG"},"hasCjsExports":false},"type":"js/module"}]}